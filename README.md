# ✦ WEEK 05 +: World System & Play In Editor

## 1. 개요

이번 주차에서는 Unreal Engine의 구조를 참고하여 월드(World), 레벨(Level), 액터(Actor), 컴포넌트(Component)로 이어지는 객체 계층 구조를 구현하는 것을 목표로 합니다. 또한, 에디터에서 즉시 게임 월드를 테스트해볼 수 있는 **PIE(Play In Editor)** 기능을 구현합니다.

이를 통해 동적인 게임 월드를 구성하고, 런타임과 에디터 상태를 분리하여 관리하는 핵심적인 엔진 아키텍처를 이해합니다.

---

## 2. 주요 구현 내용

### 2.1. UWorld / ULevel: 월드와 레벨

게임의 전체 공간을 관리하는 `UWorld`와 그 안에서 실제 액터들을 담는 컨테이너인 `ULevel`을 구현했습니다.

- **`UWorld`**:
    - 게임 세션의 최상위 객체로, 하나 이상의 레벨(`ULevel`)을 소유하고 관리합니다.
    - 월드에 존재하는 모든 액터(`AActor`)의 생명주기를 관리하며, `Tick` 함수를 통해 모든 액터와 컴포넌트를 업데이트합니다.
    - PIE 시작 시, 런타임용 월드를 복제하여 에디터와 게임 상태를 분리합니다.

- **`ULevel`**:
    - 액터들을 담고 있는 컨테이너입니다.
    - 현재는 하나의 Persistent Level만 존재하지만, 향후 레벨 스트리밍 기능을 위한 기반이 됩니다.

### 2.2. AActor / UActorComponent: 액터와 컴포넌트

- **`AActor`**:
    - 레벨에 배치할 수 있는 모든 오브젝트의 기본 클래스입니다.
    - 자체적으로는 특별한 기능을 가지지 않으며, 다양한 `UActorComponent`들을 소유함으로써 기능이 정의됩니다. (컴포넌트 패턴)
    - `Tick`, `BeginPlay`, `EndPlay`와 같은 핵심 이벤트 함수를 가집니다.

- **`UActorComponent`**:
    - 액터에 부착하여 특정 기능을 부여하는 부품입니다.
    - `Tick`, `BeginPlay`, `EndPlay` 이벤트가 액터로부터 전파되어 호출됩니다.

### 2.3. PIE (Play In Editor)

에디터에서 플레이 버튼을 누르면, 게임 로직이 시뮬레이션되는 모드입니다.

- **BeginPlay / EndPlay**:
    - PIE가 시작되면 월드 내 모든 액터와 컴포넌트의 `BeginPlay` 함수가 호출됩니다.
    - PIE가 종료되면 `EndPlay` 함수가 호출되어 게임 상태를 정리합니다.

- **Object Duplication (객체 복제)**:
    - PIE 모드 진입 시, 에디터에 존재하는 월드(`UWorld`)와 그 안의 모든 액터, 컴포넌트들을 '깊은 복사(Deep Copy)'하여 런타임용 인스턴스를 새로 생성합니다.
    - 이를 통해 원본 에디터 오브젝트는 보존하면서, 게임 플레이 중 발생하는 상태 변화(위치 이동, 파괴 등)는 복제된 런타임 오브젝트에만 적용됩니다.
    - '얕은 복사(Shallow Copy)'의 경우, 포인터나 참조만 복사되어 런타임에서의 변경이 에디터에 영향을 주는 문제가 발생할 수 있으므로, 각 객체의 상태를 완전히 복제하는 깊은 복사가 필수적입니다.

### 2.4. 신규 컴포넌트 (New Components)

- **`TextRenderComponent`**:
    - 월드 공간에 텍스트를 렌더링하는 컴포넌트입니다.
    - 기존에 각 객체의 UUID를 화면에 그리던 로직을 재사용하고 컴포넌트화하여, 원하는 텍스트를 쉽게 표시할 수 있도록 개선했습니다.

- **`BillboardComponent`**:
    - 항상 카메라를 바라보는 2D 텍스처(Sprite)를 렌더링하는 컴포넌트입니다.
    - 주로 파티클, 아이콘 등 3D 모델링 없이 간단한 이미지를 표현할 때 사용됩니다.

---

## 3. 핵심 키워드

- **Play In Editor**: 에디터 내 게임 실행 기능
- **Tick**: 매 프레임 호출되는 업데이트 함수
- **Begin, End Play**: 게임 시작과 끝 시점에 호출되는 이벤트
- **Object Duplication**: 런타임 인스턴스 생성을 위한 객체 복제
- **Deep, Shallow Copy**: 객체 복사의 두 가지 방식
- **Sprite**: 2D 이미지 리소스
- **Component Pattern**: 기능을 조합하여 객체를 구성하는 디자인 패턴
